# UC-OR3: Отменить заказ

**Актор:** Покупатель (Авторизованный пользователь)

## Цель
Пользователь отменяет ранее оформленный заказ.

## Предусловия
- Пользователь авторизован.
- Заказ находится в статусе, допускающем отмену (например, "Создан", "В обработке").
- Сервис заказов доступен.

## Основной сценарий
1. Пользователь открывает список заказов.
2. Выбирает заказ со статусом, который можно отменить.
3. Нажимает "Отменить заказ".
4. Order Service проверяет текущий статус и права доступа.
5. Статус заказа меняется на "Отменён".
6. Отправляется событие `OrderCancelled` в брокер сообщений (RabbitMQ/Kafka).
7. Если был применён резерв товара → снимается резерв, обновляются остатки (Stock Service).
8. Пользователь получает подтверждение об успешной отмене.

## Альтернативные сценарии
- **A1:** Заказ уже в статусе "Отправлен"/"Доставлен" → отмена невозможна.
- **A2:** Ошибка при обновлении статуса → возврат ошибки пользователю.
- **A3:** Сбой соединения → попробовать позже.

## Постусловия
- Статус заказа обновлён.
- Остатки товара скорректированы (если применимо).
- Событие отмены отправлено для уведомлений.